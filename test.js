const test = require('tape')

test('Generate pcap file with node', t => {
  t.plan(1)
  const generator = require('./')
  const now = Date.now()
  const packet1 = Buffer.from('450005dc51604000f206b0bbd052ec81c0a803830050e5a20faa4b8a5b3a4c675018137061350000485454502f312e3120323030204f4b0d0a436f6e6e656374696f6e3a20636c6f73650d0a6c6173742d6d6f6469666965643a204672692c203134204a616e20323031312032303a34363a313220474d540d0a43616368652d636f6e74726f6c3a207075626c69632c6d61782d6167653d333932383432380d0a5365742d436f6f6b69653a20636c5f6465665f6c616e673d656e3b20646f6d61696e3d2e6372616967736c6973742e63613b20706174683d2f3b20657870697265733d5361742c203134204a616e20323031322032303a34363a313220474d540d0a5365742d436f6f6b69653a20636c5f6465665f6c616e673d656e3b20646f6d61696e3d2e6372616967736c6973742e63613b20706174683d2f3b20657870697265733d5361742c203134204a616e20323031322032303a34363a313220474d540d0a446174653a204672692c203134204a616e20323031312032303a34363a313220474d540d0a436f6e74656e742d456e636f64696e673a20677a69700d0a566172793a204163636570742d456e636f64696e670d0a436f6e74656e742d4c656e6774683a20323339370d0a436f6e74656e742d547970653a20746578742f68746d6c3b20636861727365743d69736f2d383835392d313b0d0a5365727665723a204170616368650d0a457870697265733a205475652c203031204d617220323031312030383a30303a303020474d540d0a0d0a1f8b0800000000000003bd587b6fdb3812ff3b01f63b4c856d6f17b02d5bb6db24b59d4b9db6c935af4dddc77671082889b2194ba296a4acc89ffe66282971b30d36c1e12e8835141fc399e13c7ed4e8d9e1f974f6fbc55b589824868b4f6f4e8ea7e0b45df74b7feaba87b343389a9d9ec0a0d3edc14cb1540b2364ca62d77d7be680b33026db73dda2283a45bf23d5dc9d5dbac46ae0c6526ade094de84cb647d44584b370b2bd3532c2c47cb23b84df59c2160ccab537ec8edcaa1bc7136e18a42ce16347495f1aed402053c3533376cece0f2ea747c79fdfb6cecedf9d9f9c9c7f7168492cd2259832c32586df1837d0b848f178ec6853c65c2f38370e243c146cecb0387660a17834ded420504ccc752cb4b19a54ebdc8d5ee4b9bf1aef90426ea5caf6c897610941ccb41e3b99d446a4731cc78150ac9a7e3fa0d9564c06221c3b3c6ab67779c244dc8994e069b85f33383e1c7bbd97dd97436f38f45eb0247b6de492a7e34fde3b1dbeffbcfcdadbe99fad97e5d93a189e5ee7df8a757fe91fbcbb9a06d3b3b38bf2f4958c7e9b461f8ebdddc341acd7e99bfe87e4f25fc74747178376ba38fe7a9d463a2f3f7b9fc5f4d22f4e64b83e9dfd36f03e4fb341f16971c4cf565d67620503b3101a6ab1c0486050893a7259a5ce77565cb13490f98aab0e4f37cd1930d799dc0eb6e0cd14ee468915bc989bd74fe2e7a701f2f4739532bf74535e14fc3b56f0445e5a6be41749059ac51c5c28183a5c78c711f0ef893c93a0449e893452056540cea403290d571adae097208b942b6bc9918bee826eb385ffd673c84ba298cd3579cdf75da77a6e3bb7b29833cd81faa010660101537cef2f42fec0b5992f73832e1c67aedde48aa5e1552093244f8529af121972c528d09dc91ffbffaece7aab96f19e34d305c5b9aa241af9aaa2ac71fd0803ad99da7b79ebf5f4eaeedbf5b8d7b8f7d27af98fdcdf217e5b36338c9d2f4aa21b06ccf0b954650b0afb8e3989b720143ac8b5e61a582acd822bebb62dc013b5af85405b254267310b7858c9bb85ef3537b1e6b553d76a3cac87b7f3901edecee3f4f82c648cdbea8d288019578986f3083ea19c8dd056071ec23c1721c714c7752d78a6e442f8c23c5ae8def041e30f1f27f445258a91127300ff33c76c1ce3198814923c3602bd1102ac0e94326b93726dcd8f198416917f71150816d73ae88c25aec4e8a1ad1fa9c6ee435aec3e4e898f0b99c721f89c0a8a46a32a5489a25ea4419c6b747952084d0f6f309fb4cfa3f6f4f6886ab17d1c0019ddcb601beedf044a', 'hex')
  const packet2 = Buffer.from('450005dc51654000f206b0b6d052ec81c0a803830050e5a20faa513e5b3a4c67501813708896000013d4b7f162b45fc7094f26072b294240f74bc8635108c5f290b242c8594cd9369601d6a9f2d9086bc404c52930ba71663501a55cc97845f3bea03c5ca5f02945e95b702a535ece154b303c04ae3054b523caba01d30b813e85d52858b620a189783e218de1489621b716701d2859d883a3cdd0d1128a1c54d8726201e505ea36dc36dd802b232211d884e1ce73a62873f2cee31391354287308233399528b348234946ad2d385a78f7c10226d09f7baf90fe5297805fb1247b34158fe010fd6f0fbc6eafd7eef6dabd410b7ade5e7ff7e2142e3eceec215df22c2ed12b37b225953beca0ecdff6a25571d3be73a17f7e2ff6becefd6bd47ebc3b7cee752bb1b0610543dac6df736f40e261eb5640eba00417c6cfbb07f84f5679de3f78eebdc3ff872b090e622dc12756137cde09650d867c9cc96364b6856ca4f36cf2c7d30a842253a1675c197945e185b0ca3035e708c5aefc98a54b67f256298935ad58f0149ae9162c847a9ff6c50a421b5bcbdb03aa5a4d58e4583fc82e181bbd5d3ce7ea803dd04621ecf9c9cefe699ba773cc7f10e51813b88b9fe371c12f8a075c6446db18e668bf12110beedeeb75bb3fffdaaca5dc1f48742b0a1416eba61f0b869109f871ce216329bf1bd14b4c0321c70884a5304dafc19c514502e239c03088b00019301867cd144422c0848a503aae9ace21284c359a56d078ad0ada04a33162fa96ff1d131e6aa03246baf8b941dc450b2d6080fbb3efd3fbe7ab5f75b20582103f0f961c5d4a262e8bfd3cd16ee9edeeba97984e52be76f7abd01eaf042facaf06b95204b98f4fdf5f78fd6ebfddeb5c67f3bf1c7f85b25319c9389685331989046bb20a6ef7178fdbfffe36be4d4d6307b12839d1ff58bbc1ff47bbc1df68779f2e7959e04c7dbf5f28e38b2547d4a30cd8d6f206030754024b9310d13758a1e0b0058797f4fb661f3d6f48b4fd0dea16f59c545d9425872750365916dfea506c211d0cbb51d3a8a8f7b2a1d580d7ccd81922197a5dfc0da1dfc550a61f2e4391929b00229ad3a599386fc90aa6d95250f3c63e685fa2d5ce9646b631681a18db4875beceed3a54961ed53a9554eb54b2be6d5422a35d68718bc468c142a621438a36a247649f3b5d4b2a4e81aa18e0e06da3d7342a9661730c2d9b0334526656f8f4b152e28d93b66719c27f6cc4a6962336c8aeea195a45fecc59b816714ce2cc1188ae31c1b5607033a8c76aa2f294a2bf7e41104b6dccb998b5681f911031eaa67a367b599506dd2ea7fe7e4d6b010ae3e33363611893a89a60088a20e92281594d96645a32061aa9f2064bf09c6ab2bc899a03a226990929119c5aaea3cae678e4374181bf08531fbe583740ec8eff11909c91cc559dedc114b2697aedba31681a3502f8d0f8ccc7ca051439fc1a96f10d1cd963bd5124329daa4ad000f82071f161e302e9e859bb0d1f67079733989ecc0ede7f8476dbdeda31b8ec2f8f6f2fef71ae7c82dda3584caa857609bce7126156b610c1019683715de689d189acc0d01ed49d76ad30ffd070763e03b9a4e2481f343027ddddb0f13ced2d0eabe14a04542d9a4bc01d72ae4a18023e3d7273faa242e2bc3d3bdcd402e1a5617e4cf52549982ac7cec62d6351817891b07973971899ead2868d10107ace535cc1699f1f653bbbf03e5ce82f77fa99df8ffbc36fdde1cc1b7eedfa3dbe13be1a7477fadc8f76bc9ec7c22aefb11873abe5027758a56db3a0091f96a319c486fa7ba99fc40a29998b807a05372f9a4bc4de8688d5bda4422e3588b9f391208eecbdbefe123599caac5462be30f022c0e66b8b45372e0c746b0a3a2317a7560b1e0dc90cdd123b32ea2068aa11b3ed2254825d15687e3adb4c89150b4a0478b1081088d5ef50bd3fc4d545d045856edf52bc74ed389308a18bcf8225d8bebb9595bf6e8ff07681786df34bdd355bb1aad7f9ced57e20ecb576aff1e2a94aaca2838ed7b9d6749ed5e2c97fcfbbbe3dea27f19d500c6e6f65c78730def097d7db148b1b4c5c82b8f6cba1fd16bafd1f94443aef', 'hex')
  const packet3 = Buffer.from('4500002c51674000f206b664d052ec81c0a803830050e5a20faa56f25b3a4c6750181370ac1200007b1500000000', 'hex')

  const generated = generator([
    {
      timestamp: now,
      buffer: packet1
    }, {
      timestamp: now + 4321,
      buffer: packet2
    }, {
      timestamp: now + 8124,
      buffer: packet3
    }
  ])

  t.equals(generated.length, 3118)
})

test('Generate pcap file in browser', t => {
  t.plan(1)

  const buffer = require('buffer/').Buffer
  const generator = require('./').configure({ Buffer: buffer })
  const now = Date.now()
  const packet1 = Buffer.from('450005dc51604000f206b0bbd052ec81c0a803830050e5a20faa4b8a5b3a4c675018137061350000485454502f312e3120323030204f4b0d0a436f6e6e656374696f6e3a20636c6f73650d0a6c6173742d6d6f6469666965643a204672692c203134204a616e20323031312032303a34363a313220474d540d0a43616368652d636f6e74726f6c3a207075626c69632c6d61782d6167653d333932383432380d0a5365742d436f6f6b69653a20636c5f6465665f6c616e673d656e3b20646f6d61696e3d2e6372616967736c6973742e63613b20706174683d2f3b20657870697265733d5361742c203134204a616e20323031322032303a34363a313220474d540d0a5365742d436f6f6b69653a20636c5f6465665f6c616e673d656e3b20646f6d61696e3d2e6372616967736c6973742e63613b20706174683d2f3b20657870697265733d5361742c203134204a616e20323031322032303a34363a313220474d540d0a446174653a204672692c203134204a616e20323031312032303a34363a313220474d540d0a436f6e74656e742d456e636f64696e673a20677a69700d0a566172793a204163636570742d456e636f64696e670d0a436f6e74656e742d4c656e6774683a20323339370d0a436f6e74656e742d547970653a20746578742f68746d6c3b20636861727365743d69736f2d383835392d313b0d0a5365727665723a204170616368650d0a457870697265733a205475652c203031204d617220323031312030383a30303a303020474d540d0a0d0a1f8b0800000000000003bd587b6fdb3812ff3b01f63b4c856d6f17b02d5bb6db24b59d4b9db6c935af4dddc77671082889b2194ba296a4acc89ffe66282971b30d36c1e12e8835141fc399e13c7ed4e8d9e1f974f6fbc55b589824868b4f6f4e8ea7e0b45df74b7feaba87b343389a9d9ec0a0d3edc14cb1540b2364ca62d77d7be680b33026db73dda2283a45bf23d5dc9d5dbac46ae0c6526ade094de84cb647d44584b370b2bd3532c2c47cb23b84df59c2160ccab537ec8edcaa1bc7136e18a42ce16347495f1aed402053c3533376cece0f2ea747c79fdfb6cecedf9d9f9c9c7f7168492cd2259832c32586df1837d0b848f178ec6853c65c2f38370e243c146cecb0387660a17834ded420504ccc752cb4b19a54ebdc8d5ee4b9bf1aef90426ea5caf6c897610941ccb41e3b99d446a4731cc78150ac9a7e3fa0d9564c06221c3b3c6ab67779c244dc8994e069b85f33383e1c7bbd97dd97436f38f45eb0247b6de492a7e34fde3b1dbeffbcfcdadbe99fad97e5d93a189e5ee7df8a757fe91fbcbb9a06d3b3b38bf2f4958c7e9b461f8ebdddc341acd7e99bfe87e4f25fc74747178376ba38fe7a9d463a2f3f7b9fc5f4d22f4e64b83e9dfd36f03e4fb341f16971c4cf565d67620503b3101a6ab1c0486050893a7259a5ce77565cb13490f98aab0e4f37cd1930d799dc0eb6e0cd14ee468915bc989bd74fe2e7a701f2f4739532bf74535e14fc3b56f0445e5a6be41749059ac51c5c28183a5c78c711f0ef893c93a0449e893452056540cea403290d571adae097208b942b6bc9918bee826eb385ffd673c84ba298cd3579cdf75da77a6e3bb7b29833cd81faa010660101537cef2f42fec0b5992f73832e1c67aedde48aa5e1552093244f8529af121972c528d09dc91ffbffaece7aab96f19e34d305c5b9aa241af9aaa2ac71fd0803ad99da7b79ebf5f4eaeedbf5b8d7b8f7d27af98fdcdf217e5b36338c9d2f4aa21b06ccf0b954650b0afb8e3989b720143ac8b5e61a582acd822bebb62dc013b5af85405b254267310b7858c9bb85ef3537b1e6b553d76a3cac87b7f3901edecee3f4f82c648cdbea8d288019578986f3083ea19c8dd056071ec23c1721c714c7752d78a6e442f8c23c5ae8def041e30f1f27f445258a91127300ff33c76c1ce3198814923c3602bd1102ac0e94326b93726dcd8f198416917f71150816d73ae88c25aec4e8a1ad1fa9c6ee435aec3e4e898f0b99c721f89c0a8a46a32a5489a25ea4419c6b747952084d0f6f309fb4cfa3f6f4f6886ab17d1c0019ddcb601beedf044a', 'hex')
  const packet2 = Buffer.from('450005dc51654000f206b0b6d052ec81c0a803830050e5a20faa513e5b3a4c67501813708896000013d4b7f162b45fc7094f26072b294240f74bc8635108c5f290b242c8594cd9369601d6a9f2d9086bc404c52930ba71663501a55cc97845f3bea03c5ca5f02945e95b702a535ece154b303c04ae3054b523caba01d30b813e85d52858b620a189783e218de1489621b716701d2859d883a3cdd0d1128a1c54d8726201e505ea36dc36dd802b232211d884e1ce73a62873f2cee31391354287308233399528b348234946ad2d385a78f7c10226d09f7baf90fe5297805fb1247b34158fe010fd6f0fbc6eafd7eef6dabd410b7ade5e7ff7e2142e3eceec215df22c2ed12b37b225953beca0ecdff6a25571d3be73a17f7e2ff6becefd6bd47ebc3b7cee752bb1b0610543dac6df736f40e261eb5640eba00417c6cfbb07f84f5679de3f78eebdc3ff872b090e622dc12756137cde09650d867c9cc96364b6856ca4f36cf2c7d30a842253a1675c197945e185b0ca3035e708c5aefc98a54b67f256298935ad58f0149ae9162c847a9ff6c50a421b5bcbdb03aa5a4d58e4583fc82e181bbd5d3ce7ea803dd04621ecf9c9cefe699ba773cc7f10e51813b88b9fe371c12f8a075c6446db18e668bf12110beedeeb75bb3fffdaaca5dc1f48742b0a1416eba61f0b869109f871ce216329bf1bd14b4c0321c70884a5304dafc19c514502e239c03088b00019301867cd144422c0848a503aae9ace21284c359a56d078ad0ada04a33162fa96ff1d131e6aa03246baf8b941dc450b2d6080fbb3efd3fbe7ab5f75b20582103f0f961c5d4a262e8bfd3cd16ee9edeeba97984e52be76f7abd01eaf042facaf06b95204b98f4fdf5f78fd6ebfddeb5c67f3bf1c7f85b25319c9389685331989046bb20a6ef7178fdbfffe36be4d4d6307b12839d1ff58bbc1ff47bbc1df68779f2e7959e04c7dbf5f28e38b2547d4a30cd8d6f206030754024b9310d13758a1e0b0058797f4fb661f3d6f48b4fd0dea16f59c545d9425872750365916dfea506c211d0cbb51d3a8a8f7b2a1d580d7ccd81922197a5dfc0da1dfc550a61f2e4391929b00229ad3a599386fc90aa6d95250f3c63e685fa2d5ce9646b631681a18db4875beceed3a54961ed53a9554eb54b2be6d5422a35d68718bc468c142a621438a36a247649f3b5d4b2a4e81aa18e0e06da3d7342a9661730c2d9b0334526656f8f4b152e28d93b66719c27f6cc4a6962336c8aeea195a45fecc59b816714ce2cc1188ae31c1b5607033a8c76aa2f294a2bf7e41104b6dccb998b5681f911031eaa67a367b599506dd2ea7fe7e4d6b010ae3e33363611893a89a60088a20e92281594d96645a32061aa9f2064bf09c6ab2bc899a03a226990929119c5aaea3cae678e4374181bf08531fbe583740ec8eff11909c91cc559dedc114b2697aedba31681a3502f8d0f8ccc7ca051439fc1a96f10d1cd963bd5124329daa4ad000f82071f161e302e9e859bb0d1f67079733989ecc0ede7f8476dbdeda31b8ec2f8f6f2fef71ae7c82dda3584caa857609bce7126156b610c1019683715de689d189acc0d01ed49d76ad30ffd070763e03b9a4e2481f343027ddddb0f13ced2d0eabe14a04542d9a4bc01d72ae4a18023e3d7273faa242e2bc3d3bdcd402e1a5617e4cf52549982ac7cec62d6351817891b07973971899ead2868d10107ace535cc1699f1f653bbbf03e5ce82f77fa99df8ffbc36fdde1cc1b7eedfa3dbe13be1a7477fadc8f76bc9ec7c22aefb11873abe5027758a56db3a0091f96a319c486fa7ba99fc40a29998b807a05372f9a4bc4de8688d5bda4422e3588b9f391208eecbdbefe123599caac5462be30f022c0e66b8b45372e0c746b0a3a2317a7560b1e0dc90cdd123b32ea2068aa11b3ed2254825d15687e3adb4c89150b4a0478b1081088d5ef50bd3fc4d545d045856edf52bc74ed389308a18bcf8225d8bebb9595bf6e8ff07681786df34bdd355bb1aad7f9ced57e20ecb576aff1e2a94aaca2838ed7b9d6749ed5e2c97fcfbbbe3dea27f19d500c6e6f65c78730def097d7db148b1b4c5c82b8f6cba1fd16bafd1f94443aef', 'hex')
  const packet3 = Buffer.from('4500002c51674000f206b664d052ec81c0a803830050e5a20faa56f25b3a4c6750181370ac1200007b1500000000', 'hex')

  const generated = generator([
    {
      timestamp: now,
      buffer: packet1
    }, {
      timestamp: now + 4321,
      buffer: packet2
    }, {
      timestamp: now + 8124,
      buffer: packet3
    }
  ])

  t.equals(generated.length, 3118)
})
/*

import PcapGenerator from 'pcap-generator'
import { Buffer } from 'buffer'

const generator = PcapGenerator()
*/
/*

import PcapGenerator from 'pcap-generator'
import { Buffer } from 'buffer'

const generator = PcapGenerator()
*/
